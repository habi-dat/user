extends layout
include various
include user/user

block content
    +notification(notification, message, responses)
    .row
      .col-md-7
        .panel.panel-default
          .panel-heading
            h2.panel-title 
              span Benutzer 
              span
                a.btn.btn-default.btn-sm(href='/user/add' title='Benutzer*in erstellen') 
                  span.glyphicon.glyphicon-plus
              span
                a.btn.btn-default.btn-sm(href='/user/invite' title='Benutzer*in einladen') 
                  span.glyphicon.glyphicon-envelope

          .panel-body
            +user_table(users)(editActions=true)
      .col-md-5
        .panel.panel-default
          .panel-heading
            h2.panel-title 
              span Gruppen 
              if (currentUser.isAdmin)
                span
                  a.btn.btn-default.btn-sm(href='/group/add') 
                    span.glyphicon.glyphicon-plus
          .panel-body
            table.table.datatable(id='grouptable')
              thead
                tr
                  th.col-md-3 Interner Name
                  th.col-md-3 Anzeigename
                  th.col-md-4 Beschreibung
                  if currentUser.isAdmin
                    th.col-md-2.text-right(data-orderable="false") Aktionen
                  th.hidden Members
                  th.hidden Admins
              tbody
                each group in groups
                  if (group.cn)
                    tr
                      td= group.cn
                      td= group.o
                      td= group.description
                      if currentUser.isAdmin
                        td.text-right
                          a.btn.btn-default.btn-sm(href='/group/edit/'+group.dn) #[span.glyphicon.glyphicon-pencil]
                          a.btn.btn-default.btn-sm.confirm(data-link='/group/delete/'+group.dn, data-confirmtext='Willst du die Gruppe ' + group.cn + ' wirklich l√∂schen?') #[span.glyphicon.glyphicon-trash]
                      td.hidden.dn 
                        if (group.member && group.member instanceof Array)
                          each member in group.member
                            .memberdn= member
                        else if (group.member)
                            .memberdn= group.member
                      td.hidden.dn 
                        if (group.owner && group.owner instanceof Array)
                          each admin in group.owner
                            .admindn= admin
                        else if (group.owner)
                            .admindn= group.owner